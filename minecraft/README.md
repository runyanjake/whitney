# Whitney Minecraft

PWS hosts Minecraft servers. Based off of `https://github.com/nimmis/docker-spigot` for 1.16 and `https://github.com/itzg/docker-minecraft-server` for 1.17+ as spigot is no longer maintained past 2019.
</br>
Data stored on disk rather than docker volume so things like the config can be edited via just ssh.
Expects a `server.properties` file with a suffix denoting version (e.g. `server_1.17.properties`) that will overwrite the one generated by spigot.
</br>
Minecraft emits metrics for prometheus to collect via `https://github.com/sladkoff/minecraft-prometheus-exporter`. Clone the repo & build the project into a jar and copy it into the `/plugins` directory for minecraft. 
Take special care to overwrite the plugin's default "hostname" to `0.0.0.0` to allow all traffic in the config file. This allows the plugin to listen to traffic from outside the container (namely the prometheus instance). 
</br>
Monitoring commands to get logs from the container are documented in the github repo.
</br>
example: `docker exec minecraft_whitney_1.17 mc_log`
### Build all components with Docker Compose

`docker-compose up -d`

### Start with Plain Docker

`docker run -d -p 25565:25565 --network=host --restart=always --name=minecraft_1.16_whitney -e EULA=true -e MC_MAXMEM=2g -e MC_MINMEM=512m -v /data/minecraft_1.16:/minecraft nimmis/spigot`
`docker run -d -p 25565:25565 --restart=always -e TYPE=SPIGOT --name=minecraft_1.17_whitney -e EULA=TRUE -v /data/minecraft_1.17:/data -v ./server.properties:/data/server.properties itzg/minecraft-server`
